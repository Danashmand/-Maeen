(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{7979:function(e,t,r){Promise.resolve().then(r.bind(r,6535))},518:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(5624),s=r.n(a)},4929:function(e,t,r){"use strict";var a=r(9998);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},5624:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return c},getImageProps:function(){return n}});let a=r(1462),s=r(908),i=r(9795),l=a._(r(2864));function n(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let c=i.Image},2788:function(e,t,r){"use strict";r.d(t,{Z:function(){return f}});var a=r(9676);r(6030);var s=r(4929),i=r(5087),l=r(518),n=r(7415),c={src:"/_next/static/media/annotation.3fcc1e3a.svg",height:24,width:24,blurWidth:0,blurHeight:0},o={src:"/_next/static/media/equal-circle.c5a587e0.svg",height:24,width:24,blurWidth:0,blurHeight:0},d={src:"/_next/static/media/vector.23b81414.svg",height:20,width:21,blurWidth:0,blurHeight:0},u={src:"/_next/static/media/logout.1deafb10.svg",height:24,width:24,blurWidth:0,blurHeight:0};let h=e=>{let{iconSrc:t,label:r,href:s,isActive:i}=e;return(0,a.jsx)("div",{children:(0,a.jsxs)("a",{href:s||"#",className:"flex ml-4 gap-y-20 items-center space-x-2 p-3 rounded-2xl ".concat(i?"bg-secondary2":"hover:bg-secondary2"),children:[(0,a.jsx)(l.default,{src:t,alt:r,width:24,height:24}),(0,a.jsx)("span",{className:"text-md font-bold",children:r})]})})};var f=()=>{let e=(0,s.usePathname)(),t=[{iconSrc:d,label:"الحكواتي ",href:"/dashboard/imporve-reading"},{iconSrc:c,label:"ياقوت",href:"/dashboard/virtual-teacher"},{iconSrc:n.Z,label:"جاسر",href:"/dashboard/spelling-correction"},{iconSrc:o,label:"اختبر نفسك",href:"/dashboard/test-yourself"}];return(0,a.jsxs)("div",{className:"h-full m-8 w-56 bg-gradient-to-b from-primary to-secondary2 rounded-3xl text-white flex flex-col p-1 relative",children:[(0,a.jsx)("div",{className:"absolute top-0 m-0 left-0 right-0 h-24 w-64 rounded-3xl bg-gradient-to-b from-white/30 to-transparent"}),(0,a.jsx)("div",{className:"text-center mb-1 mr-6",children:(0,a.jsx)(l.default,{src:i.default,alt:"Logo",className:"mx-auto"})}),(0,a.jsx)("nav",{className:"flex-grow",children:(0,a.jsx)("ul",{className:"space-y-1.5",children:t.map((t,r)=>(0,a.jsx)(h,{iconSrc:t.iconSrc,label:t.label,href:t.href,isActive:e===t.href},r))})}),(0,a.jsx)("div",{className:"mt-auto",children:(0,a.jsx)(h,{iconSrc:u,label:"تسجيل الخروج",href:"../auth/signin"})})]})}},6535:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var a=r(9676),s=r(6030),i=r(2788),l=r(1330),n=r(518),c=r(4929),o=r(3568),d=r(1540),u={src:"/_next/static/media/1500 Memoji Pack.3c05df2f.svg",height:256,width:256,blurWidth:0,blurHeight:0},h=function(){let[e,t]=(0,s.useState)([]),[r,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)(""),x=(0,s.useRef)(null),[g,b]=(0,s.useState)(null),[p,v]=(0,s.useState)(null),w=(0,c.useRouter)(),[j,y]=(0,s.useState)("text-secondary"),[N,A]=(0,s.useState)(g?g.score:0);(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("user");e?b(JSON.parse(e).userData):w.push("/auth/signin")})()},[]),(0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch("https://maeen-production.up.railway.app/virtual-teacher/start-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:null==g?void 0:g._id})});if(!e.ok)throw Error("Failed to create a new chat session");let t=await e.json();if(v(t.ChatId),t.ChatId)localStorage.setItem("chatId",t.ChatId);else throw Error("Chat ID not returned from the server")}catch(e){console.error("Error creating chat session",e)}};g&&e()},[g]);let S=async e=>{e.preventDefault();let r={createdAt:new Date().toISOString(),prompt:f,answer:""};if(t(e=>[...e,r]),m(""),g){let e=g.score+10;b({...g,score:e}),y("text-green-500"),setTimeout(()=>y("text-green-500"),900),setTimeout(()=>y("text-secondary"),2e3),I(g.score,e,1e3)}h(!0);try{if(!p)throw Error("Chat ID is missing. Please start a new chat session.");let e=await fetch("https://maeen-production.up.railway.app/virtual-teacher/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:f,userId:null==g?void 0:g._id,chatId:p})});if(!e.ok)throw Error("Failed to fetch teacher response");let r=await e.json(),a={prompt:"",answer:_(r.text)};t(e=>{let t=[...e];return t[t.length-1].answer=a.answer,t})}catch(e){console.error("Error fetching the API",e)}finally{h(!1),P()}},I=(e,t,r)=>{let a=(t-e)/10,s=e,i=0,l=setInterval(()=>{if(i>=10){clearInterval(l);return}A(Math.round(s+=a)),i++},r/10)},_=e=>e.replace(/\bAI\b/g,"").replace(/ AI/g,"").replace(/AI\b/g,"").replace(/(.*?):/g,"<b style='font-weight: 900; font-size: 1rem;'>$1</b>:").replace(/\*\*(.*?)\*\*/g,"<b style='font-weight: 900; font-size: 1rem;'>$1</b>").replace(/(\d+\.\s+)/g,"<br>$1"),P=()=>{var e;null===(e=x.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return(0,s.useEffect)(()=>{P()},[e]),(0,a.jsxs)("div",{className:"relative  h-screen flex flex-roww-full overflow-hidden text-right bg-white/95  ",children:[(0,a.jsx)("div",{className:"mb-20",children:(0,a.jsx)(i.Z,{})}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4 overflow-y-auto  bg-white/90 mb-5 mt-10 mr-1  w-[119vh] bg-opacity-10 p-6 rounded-3xl shadow-xl backdrop-blur-md ",dir:"ltr",children:[(0,a.jsxs)("div",{className:"flex flex-row  justify-between  text-secondary2 text-3xl  font-extrabold ",children:[(0,a.jsxs)("div",{className:"flex flex-row justify-start ml-3  border-2 rounded-xl text-lg border-white/50",children:[(0,a.jsx)("div",{className:"w-14 flex justify-center bg-white rounded-full border-4 border-secondary mr-4 ",children:(0,a.jsx)(n.default,{src:d.Z,alt:"Logo",className:"w-16"})}),(0,a.jsxs)("div",{className:"flex-col flex",children:[(0,a.jsxs)("div",{children:[" ",g?g.name:"مستخدم"]}),(0,a.jsxs)("div",{className:j,children:["نقاطك: ",N]})]})]}),(0,a.jsx)(n.default,{src:o.Z,alt:"logo",className:"w-10"}),(0,a.jsx)("div",{className:"flex justify-center text-center mt-1 ",children:"ياقوت"})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2 overflow-y-auto flex-grow bg-white bg-opacity-10 p-6 h-[75vh] backdrop-blur-md transition-transform duration-300 ease-in-out",dir:"rtl",children:[e.map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-col",children:[e.prompt&&""!==e.prompt.trim()&&(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(n.default,{src:l.Z,alt:"Student Icon",className:"w-8 h-8 rounded-full ml-2"}),(0,a.jsx)("div",{className:"border border-secondary2 p-3 rounded-xl text-secondary2 animate-fade-in-up text-md leading-relaxed max-w-[75%]",children:e.prompt})]}),e.answer&&(0,a.jsxs)("div",{className:"flex items-center justify-end mt-2",children:[(0,a.jsx)("div",{className:" p-3 max-w-[75%] rounded-xl text-black animate-fade-in-up text-lg leading-relaxed border-r-2  border-secondary2",dangerouslySetInnerHTML:{__html:e.answer}}),(0,a.jsx)(n.default,{src:l.Z,alt:"Teacher Icon",className:"w-8 h-8 rounded-full mr-2"})]})]},t)),r&&(0,a.jsx)("div",{className:"self-end italic text-primary animate-pulse text-lg",children:"المعلم يكتب  ..."}),(0,a.jsx)("div",{ref:x})]}),(0,a.jsxs)("form",{onSubmit:S,className:"flex items-center space-x-4 pt-6",children:[(0,a.jsx)("input",{type:"text",className:"flex-grow p-2 text-right rounded-full border-2  border-primary focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition duration-200 ease-in-out text-gray-900 bg-white text-lg leading-relaxed",placeholder:"...اسأل شيئًا",value:f,onChange:e=>m(e.target.value)}),(0,a.jsx)("button",{type:"submit",className:"bg-primary text-white rounded-full px-6 py-2 transition duration-200 ease-in-out hover:bg-secondary",children:"إرسال"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col bg-gradient-to-b from-primary to-secondary2 p-8 rounded-[10%] items-center text-center justify-center flex w-80 mx-4 mt-2 h-3/4",children:[(0,a.jsx)("h2",{className:"flex gap-1 text-2xl font-bold",dir:"rtl",children:"أنا ياقوت معلمك الافتراضي اسألني ما شئت !      "}),(0,a.jsx)("div",{children:(0,a.jsx)(n.default,{src:u,alt:"face",className:"w-52"})})]})]})}},1330:function(e,t){"use strict";t.Z={src:"/_next/static/media/R.c6f35535.png",height:1902,width:2232,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAQAAACfUMTVAAAASklEQVR42g3HIRZAQAAFwKmea8giR3ADTRBs2hUVd5D2wP6bNLB6XPFYYVHNSsxq5jW4jXEbMgcaaMhOVF9UZM2mmKLYMrsOoNt/f0QPJaqNeB0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:7}},1540:function(e,t){"use strict";t.Z={src:"/_next/static/media/face.7414295a.svg",height:40,width:40,blurWidth:0,blurHeight:0}},5087:function(e,t,r){"use strict";r.r(t),t.default={src:"/_next/static/media/logo.9bccf0e3.svg",height:83,width:126,blurWidth:0,blurHeight:0}},3568:function(e,t){"use strict";t.Z={src:"/_next/static/media/logocolored.406f4bad.svg",height:52,width:51,blurWidth:0,blurHeight:0}},7415:function(e,t){"use strict";t.Z={src:"/_next/static/media/pencil.77d57241.svg",height:24,width:24,blurWidth:0,blurHeight:0}}},function(e){e.O(0,[795,82,890,744],function(){return e(e.s=7979)}),_N_E=e.O()}]);